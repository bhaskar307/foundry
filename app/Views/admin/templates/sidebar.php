<?php
$currentUrl = $_SERVER['REQUEST_URI'];
$urlSegments = explode('/', trim($currentUrl, '/')); // Split URL into segments
$lastSegment = end($urlSegments); // Get the last segment
$user_role = session()->get('user_role');

use Config\Services;

$request = Services::request();
$jwt = $request->getCookie(TOKEN_NAME_JWT);
if (empty($jwt)) {
    return view('admin/login.php');
}
$data = validateJWT($jwt);
if (!$data) {
    return view('admin/login.php');
}
?>
<div class="sidebar">
    <div class="sidebar-inner">
        <div class="sidebar-header px-3 py-2 border-bottom">
            <div class="d-flex align-items-center justify-content-between justify-content-lg-center h-100">
                <a href="<?= base_url('admin/dashboard') ?>">
                    <img src="<?php echo base_url('assets/admin/images/foundry_logo.webp') ?>" alt="" width="100" style="height: auto;">
                </a>
                <div class="d-md-none">
                    <button class="btnico mnucls">
                        <svg width="24" height="24" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_88_6)">
                                <path d="M25 512C20.0548 512.001 15.2204 510.535 11.1083 507.788C6.99622 505.041 3.79119 501.137 1.89861 496.568C0.00603998 491.999 -0.489051 486.972 0.475965 482.122C1.44098 477.271 3.82275 472.816 7.32 469.32L469.32 7.32012C474.009 2.63109 480.369 -0.00317383 487 -0.00317383C493.631 -0.00317383 499.991 2.63109 504.68 7.32012C509.369 12.0091 512.003 18.3688 512.003 25.0001C512.003 31.6314 509.369 37.9911 504.68 42.6801L42.68 504.68C40.3604 507.005 37.6044 508.848 34.5703 510.104C31.5362 511.36 28.2838 512.005 25 512Z" fill="#fff" />
                                <path d="M487 512C483.716 512.005 480.464 511.36 477.43 510.104C474.396 508.848 471.64 507.005 469.32 504.68L7.32001 42.6801C2.63098 37.9911 -0.00328827 31.6314 -0.00328827 25.0001C-0.00328827 18.3688 2.63098 12.0091 7.32001 7.32012C12.009 2.63109 18.3687 -0.00317383 25 -0.00317383C31.6313 -0.00317383 37.991 2.63109 42.68 7.32012L504.68 469.32C508.177 472.816 510.559 477.271 511.524 482.122C512.489 486.972 511.994 491.999 510.101 496.568C508.209 501.137 505.004 505.041 500.892 507.788C496.78 510.535 491.945 512.001 487 512Z" fill="#fff" />
                            </g>
                            <defs>
                                <clipPath id="clip0_88_6">
                                    <rect width="512" height="512" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div class="sidebar-nav overflow-auto">
            <ul class="m-0 p-3 list-unstyled mainmenu" id="mainmenu">
                <li>
                    <a href="<?= base_url('admin/dashboard') ?>" <?= ($lastSegment == 'dashboard') ? 'class="active"' : '' ?>>
                        <i>
                            <svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M9.90452 0C11.9806 0.219665 13.9207 1.18828 15.396 2.74173C16.8714 4.29518 17.7914 6.33791 18 8.52381H16.2362C15.9963 8.52381 15.7662 8.62415 15.5966 8.80276C15.427 8.98136 15.3317 9.2236 15.3317 9.47619C15.3317 9.72878 15.427 9.97102 15.5966 10.1496C15.7662 10.3282 15.9963 10.4286 16.2362 10.4286H18C17.5468 15.241 13.6899 19 9 19C4.31005 19 0.453166 15.241 0 10.4286H1.76382C2.00371 10.4286 2.23378 10.3282 2.40341 10.1496C2.57304 9.97102 2.66834 9.72878 2.66834 9.47619C2.66834 9.2236 2.57304 8.98136 2.40341 8.80276C2.23378 8.62415 2.00371 8.52381 1.76382 8.52381H0C0.208627 6.33791 1.12857 4.29518 2.60396 2.74173C4.07934 1.18828 6.01942 0.219665 8.09548 0V1.85714C8.09548 2.10973 8.19077 2.35197 8.3604 2.53058C8.53004 2.70918 8.76011 2.80952 9 2.80952C9.23989 2.80952 9.46996 2.70918 9.63959 2.53058C9.80922 2.35197 9.90452 2.10973 9.90452 1.85714V0ZM14.2281 3.97143L9.84754 6.31905L9.51015 6.50667L8.95839 6.8019C8.30714 7.15429 7.64322 7.53714 7.14482 8.0619C6.26653 8.98762 6.1598 10.5267 7.08151 11.4962C8.00231 12.4667 9.46402 12.3543 10.3432 11.4295C10.7701 10.98 11.0985 10.4029 11.3943 9.81428L11.8203 8.93905L12.1477 8.27429L14.2281 3.97143ZM10.0511 8.36952L9.94975 8.56952L9.84754 8.77524C9.65849 9.15809 9.46221 9.55809 9.21618 9.89143L9.06422 10.0819C8.81276 10.3467 8.49889 10.2952 8.3605 10.1495C8.23568 10.0181 8.18322 9.73809 8.35779 9.49048L8.42382 9.40952C8.71236 9.12952 9.07869 8.90857 9.44593 8.70476L9.66573 8.58381C9.79839 8.51206 9.92683 8.44063 10.0511 8.36952Z" fill="#0D9488" />
                            </svg>
                        </i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="<?= base_url('admin/customers') ?>" <?= ($lastSegment == 'customers') ? 'class="active"' : '' ?>>
                        <i>
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.1201 3.66836L17.4726 3.31378L17.1201 3.66836C17.275 3.82233 17.3803 4.04087 17.4386 4.47195C17.4989 4.91782 17.5 5.51044 17.5 6.36841C17.5 6.56095 17.4992 6.67542 17.4922 6.75505C17.4112 6.76236 17.2952 6.76314 17.1 6.76314H0.9C0.704654 6.76314 0.58867 6.76237 0.507877 6.7551C0.500782 6.67534 0.5 6.56083 0.5 6.36841C0.5 5.51044 0.501076 4.91782 0.561409 4.47195C0.619743 4.04087 0.725044 3.82233 0.879915 3.66836C1.03519 3.514 1.25621 3.40877 1.69123 3.35059C2.14043 3.29051 2.73723 3.28946 3.6 3.28946H14.4C15.2628 3.28946 15.8596 3.29051 16.3088 3.35059C16.7438 3.40877 16.9648 3.514 17.1201 3.66836Z" fill="#6C757D" stroke="#6C757D" />
                                <path d="M0.879915 17.1211C0.725044 16.9671 0.619743 16.7486 0.561409 16.3175C0.501076 15.8717 0.5 15.279 0.5 14.4211V9.94738C0.5 9.75483 0.500781 9.64036 0.507839 9.56072C0.588757 9.55342 0.704787 9.55264 0.9 9.55264H17.1C17.2954 9.55264 17.4114 9.55342 17.4921 9.56069C17.4992 9.64033 17.5 9.75481 17.5 9.94738V14.4211C17.5 15.279 17.4989 15.8717 17.4386 16.3175C17.3803 16.7486 17.275 16.9671 17.1201 17.1211C16.9648 17.2755 16.7438 17.3807 16.3088 17.4389C15.8596 17.499 15.2628 17.5 14.4 17.5H3.6C2.73723 17.5 2.14043 17.499 1.69123 17.4389C1.25621 17.3807 1.03519 17.2755 0.879915 17.1211ZM5.4 12.1316C5.02964 12.1316 4.67386 12.2778 4.41109 12.5391C4.14822 12.8004 4 13.1555 4 13.5263C4 13.8972 4.14822 14.2523 4.41109 14.5136C4.67386 14.7748 5.02964 14.9211 5.4 14.9211H12.6C12.9704 14.9211 13.3261 14.7748 13.5889 14.5136C13.8518 14.2523 14 13.8972 14 13.5263C14 13.1555 13.8518 12.8004 13.5889 12.5391C13.3261 12.2778 12.9704 12.1316 12.6 12.1316H5.4Z" fill="#6C757D" stroke="#6C757D" />
                                <path d="M4.5 1V3.68421V1ZM13.5 1V3.68421V1Z" fill="#6C757D" />
                                <path d="M4.5 1V3.68421M13.5 1V3.68421" stroke="#6C757D" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </i>
                        <span>Customers</span>
                    </a>
                </li>
                <li>
                    <a href="<?= base_url('admin/vendors') ?>" <?= ($lastSegment == 'vendors') ? 'class="active"' : '' ?>>
                        <i>
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.1201 3.66836L17.4726 3.31378L17.1201 3.66836C17.275 3.82233 17.3803 4.04087 17.4386 4.47195C17.4989 4.91782 17.5 5.51044 17.5 6.36841C17.5 6.56095 17.4992 6.67542 17.4922 6.75505C17.4112 6.76236 17.2952 6.76314 17.1 6.76314H0.9C0.704654 6.76314 0.58867 6.76237 0.507877 6.7551C0.500782 6.67534 0.5 6.56083 0.5 6.36841C0.5 5.51044 0.501076 4.91782 0.561409 4.47195C0.619743 4.04087 0.725044 3.82233 0.879915 3.66836C1.03519 3.514 1.25621 3.40877 1.69123 3.35059C2.14043 3.29051 2.73723 3.28946 3.6 3.28946H14.4C15.2628 3.28946 15.8596 3.29051 16.3088 3.35059C16.7438 3.40877 16.9648 3.514 17.1201 3.66836Z" fill="#6C757D" stroke="#6C757D" />
                                <path d="M0.879915 17.1211C0.725044 16.9671 0.619743 16.7486 0.561409 16.3175C0.501076 15.8717 0.5 15.279 0.5 14.4211V9.94738C0.5 9.75483 0.500781 9.64036 0.507839 9.56072C0.588757 9.55342 0.704787 9.55264 0.9 9.55264H17.1C17.2954 9.55264 17.4114 9.55342 17.4921 9.56069C17.4992 9.64033 17.5 9.75481 17.5 9.94738V14.4211C17.5 15.279 17.4989 15.8717 17.4386 16.3175C17.3803 16.7486 17.275 16.9671 17.1201 17.1211C16.9648 17.2755 16.7438 17.3807 16.3088 17.4389C15.8596 17.499 15.2628 17.5 14.4 17.5H3.6C2.73723 17.5 2.14043 17.499 1.69123 17.4389C1.25621 17.3807 1.03519 17.2755 0.879915 17.1211ZM5.4 12.1316C5.02964 12.1316 4.67386 12.2778 4.41109 12.5391C4.14822 12.8004 4 13.1555 4 13.5263C4 13.8972 4.14822 14.2523 4.41109 14.5136C4.67386 14.7748 5.02964 14.9211 5.4 14.9211H12.6C12.9704 14.9211 13.3261 14.7748 13.5889 14.5136C13.8518 14.2523 14 13.8972 14 13.5263C14 13.1555 13.8518 12.8004 13.5889 12.5391C13.3261 12.2778 12.9704 12.1316 12.6 12.1316H5.4Z" fill="#6C757D" stroke="#6C757D" />
                                <path d="M4.5 1V3.68421V1ZM13.5 1V3.68421V1Z" fill="#6C757D" />
                                <path d="M4.5 1V3.68421M13.5 1V3.68421" stroke="#6C757D" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </i>
                        <span>Vendors</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="sidebar-footer p-2 border-top mt-auto">
            <a href="<?= base_url('clinic/logout') ?>" class="btn btn-green w-100 d-flex gap-3 align-items-center justify-content-center">
                <i style="line-height: 0;">
                    <svg width="18" height="18" viewBox="0 0 28 28" fill="#fff" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20.907 3.32825V5.49011C20.907 5.63772 20.9729 5.7761 21.0891 5.86836C21.3559 6.08362 21.6134 6.31426 21.8583 6.55721C22.8737 7.5508 23.6829 8.72775 24.2412 10.023C24.8198 11.3648 25.1166 12.807 25.114 14.2637C25.114 15.7367 24.8188 17.1636 24.2412 18.5044C23.6829 19.7996 22.8737 20.9765 21.8583 21.9701C20.8463 22.9655 19.6468 23.7592 18.3263 24.3073C16.9575 24.8762 15.5039 25.1622 14 25.1622C12.4962 25.1622 11.0426 24.8731 9.67375 24.3073C8.35201 23.7599 7.16213 22.9726 6.14178 21.9701C5.12144 20.9676 4.31772 19.8021 3.75888 18.5044C3.18121 17.1636 2.88609 15.7367 2.88609 14.2637C2.88609 12.7906 3.17807 11.3637 3.75888 10.023C4.31772 8.72522 5.12144 7.55972 6.14178 6.55721C6.3898 6.31426 6.64725 6.0867 6.91097 5.86836C7.02713 5.7761 7.09306 5.63465 7.09306 5.49011L7.09306 3.32825C7.09306 3.13451 6.87329 3.01457 6.7069 3.12221C2.96458 5.48088 0.487489 9.6078 0.500048 14.2975C0.518885 21.6657 6.62527 27.5731 14.1382 27.4993C21.5318 27.4255 27.5 21.5273 27.5 14.2637C27.5 9.58628 25.0261 5.47781 21.2931 3.12221C21.1268 3.01765 20.907 3.13451 20.907 3.32825ZM13.8022 0.594391L10.286 4.9581C10.1541 5.12109 10.2734 5.35788 10.4838 5.35788H12.8698L12.8698 15.014C12.8698 15.1493 12.9828 15.26 13.121 15.26H14.8791C15.0172 15.26 15.1303 15.1493 15.1303 15.014L15.1303 5.35788H17.5163C17.7266 5.35788 17.8459 5.11801 17.7141 4.9581L14.1978 0.594391C14.1743 0.564987 14.1443 0.541206 14.11 0.524853C14.0758 0.508497 14.0381 0.5 14 0.5C13.9619 0.5 13.9243 0.508497 13.89 0.524853C13.8557 0.541206 13.8257 0.564987 13.8022 0.594391Z" />
                    </svg>
                </i>
                <span>Logout</span>
            </a>
        </div>
    </div>
    <div class="sidebaroverly d-md-none"></div>
</div>